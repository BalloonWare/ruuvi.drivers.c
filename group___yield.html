<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ruuvi.drivers.c: Yield and delay functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ruuvi.drivers.c
   &#160;<span id="projectnumber">${PROJECT_VERSION}</span>
   </div>
   <div id="projectbrief">Drivers for external sensors and peripherals on embedded systems.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___yield.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Yield and delay functions</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions for ceasing the execution of the program, either until some event occurs or until a desired time has passed.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:ruuvi__interface__yield_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ruuvi__interface__yield_8h.html">ruuvi_interface_yield.h</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gad5480f7b0a184481c5574b2c5dc51967"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___yield.html#gad5480f7b0a184481c5574b2c5dc51967">ri_yield_state_ind_fp_t</a>) (const bool active)</td></tr>
<tr class="memdesc:gad5480f7b0a184481c5574b2c5dc51967"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable implementation selected by application.  <a href="#gad5480f7b0a184481c5574b2c5dc51967">More...</a><br /></td></tr>
<tr class="separator:gad5480f7b0a184481c5574b2c5dc51967"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga98ea6648cb2f0858572aefb15085dbc0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___yield.html#ga98ea6648cb2f0858572aefb15085dbc0">ri_yield_indication_set</a> (const <a class="el" href="group___yield.html#gad5480f7b0a184481c5574b2c5dc51967">ri_yield_state_ind_fp_t</a> indication)</td></tr>
<tr class="separator:ga98ea6648cb2f0858572aefb15085dbc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga20f61ffc1f1ab0b0ee4124fb161be558"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___error.html#ga3e1919cc1fe75cb7f12af047f6f4ce55">rd_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___yield.html#ga20f61ffc1f1ab0b0ee4124fb161be558">ri_yield_init</a> (void)</td></tr>
<tr class="memdesc:ga20f61ffc1f1ab0b0ee4124fb161be558"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes yielding functions.  <a href="#ga20f61ffc1f1ab0b0ee4124fb161be558">More...</a><br /></td></tr>
<tr class="separator:ga20f61ffc1f1ab0b0ee4124fb161be558"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga013f419a3299af1e7353b2fa2d1756c2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___error.html#ga3e1919cc1fe75cb7f12af047f6f4ce55">rd_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___yield.html#ga013f419a3299af1e7353b2fa2d1756c2">ri_yield_uninit</a> (void)</td></tr>
<tr class="memdesc:ga013f419a3299af1e7353b2fa2d1756c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Uninitializes yielding functions.  <a href="#ga013f419a3299af1e7353b2fa2d1756c2">More...</a><br /></td></tr>
<tr class="separator:ga013f419a3299af1e7353b2fa2d1756c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafdd7b29a7f593e398104247709e1bf0b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___error.html#ga3e1919cc1fe75cb7f12af047f6f4ce55">rd_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___yield.html#gafdd7b29a7f593e398104247709e1bf0b">ri_yield_low_power_enable</a> (const bool enable)</td></tr>
<tr class="memdesc:gafdd7b29a7f593e398104247709e1bf0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes yielding functions.  <a href="#gafdd7b29a7f593e398104247709e1bf0b">More...</a><br /></td></tr>
<tr class="separator:gafdd7b29a7f593e398104247709e1bf0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga96e55803923f9623358ef8da678f3ac1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___error.html#ga3e1919cc1fe75cb7f12af047f6f4ce55">rd_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___yield.html#ga96e55803923f9623358ef8da678f3ac1">ri_yield</a> (void)</td></tr>
<tr class="memdesc:ga96e55803923f9623358ef8da678f3ac1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function which will release execution.  <a href="#ga96e55803923f9623358ef8da678f3ac1">More...</a><br /></td></tr>
<tr class="separator:ga96e55803923f9623358ef8da678f3ac1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeef8bef35e57bed30256a918bc01c4e5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___error.html#ga3e1919cc1fe75cb7f12af047f6f4ce55">rd_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___yield.html#gaeef8bef35e57bed30256a918bc01c4e5">ri_delay_ms</a> (uint32_t time)</td></tr>
<tr class="memdesc:gaeef8bef35e57bed30256a918bc01c4e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delay a given number of milliseconds.  <a href="#gaeef8bef35e57bed30256a918bc01c4e5">More...</a><br /></td></tr>
<tr class="separator:gaeef8bef35e57bed30256a918bc01c4e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa92fb9ba93e27a28c3e3a5659eac1f82"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___error.html#ga3e1919cc1fe75cb7f12af047f6f4ce55">rd_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___yield.html#gaa92fb9ba93e27a28c3e3a5659eac1f82">ri_delay_us</a> (uint32_t time)</td></tr>
<tr class="memdesc:gaa92fb9ba93e27a28c3e3a5659eac1f82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delay a given number of microseconds.  <a href="#gaa92fb9ba93e27a28c3e3a5659eac1f82">More...</a><br /></td></tr>
<tr class="separator:gaa92fb9ba93e27a28c3e3a5659eac1f82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga448f8ec0a3530ab6d6a14ef59bc5eafb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___yield.html#ga448f8ec0a3530ab6d6a14ef59bc5eafb">ri_yield_is_interrupt_context</a> (void)</td></tr>
<tr class="memdesc:ga448f8ec0a3530ab6d6a14ef59bc5eafb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if current execution is in interrupt context.  <a href="#ga448f8ec0a3530ab6d6a14ef59bc5eafb">More...</a><br /></td></tr>
<tr class="separator:ga448f8ec0a3530ab6d6a14ef59bc5eafb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Functions for ceasing the execution of the program, either until some event occurs or until a desired time has passed. </p>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="gad5480f7b0a184481c5574b2c5dc51967"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad5480f7b0a184481c5574b2c5dc51967">&#9670;&nbsp;</a></span>ri_yield_state_ind_fp_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* ri_yield_state_ind_fp_t) (const bool active)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable implementation selected by application. </p>
<p>Function which gets called when entering / exiting sleep, configured by application.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">active</td><td>true if device is going to be active, false otherwise. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ruuvi__interface__yield_8h_source.html#l00035">35</a> of file <a class="el" href="ruuvi__interface__yield_8h_source.html">ruuvi_interface_yield.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaeef8bef35e57bed30256a918bc01c4e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeef8bef35e57bed30256a918bc01c4e5">&#9670;&nbsp;</a></span>ri_delay_ms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___error.html#ga3e1919cc1fe75cb7f12af047f6f4ce55">rd_status_t</a> ri_delay_ms </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delay a given number of milliseconds. </p>
<p>This function is meant for rough timing and is not quaranteed to be exact in any manner If you need exact timing use timers or for example PWM peripheral. This function is affected by low-power delay enable, which uses sleep mode and timer to return out of sleep.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>number of milliseconds to delay. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>RD_SUCCESS on success, error code from stack on error. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Underlying implementation may block execution and keep CPU active leading to high power consumption </dd>
<dd>
The timing is indicative only and should not be relied for precise timing. </dd></dl>

</div>
</div>
<a id="gaa92fb9ba93e27a28c3e3a5659eac1f82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa92fb9ba93e27a28c3e3a5659eac1f82">&#9670;&nbsp;</a></span>ri_delay_us()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___error.html#ga3e1919cc1fe75cb7f12af047f6f4ce55">rd_status_t</a> ri_delay_us </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delay a given number of microseconds. </p>
<p>This function is meant for rough timing and is not quaranteed to be exact in any manner If you need exact timing use timers or for example PWM peripheral. This function does not use low-power mode to maintain better precision on timing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>number of microseconds to delay. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>RD_SUCCESS on success, error code from stack on error. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Underlying implementation may block execution and keep CPU active leading to high power consumption </dd>
<dd>
The timing is indicative only and should not be relied for precise timing. </dd></dl>

</div>
</div>
<a id="ga96e55803923f9623358ef8da678f3ac1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga96e55803923f9623358ef8da678f3ac1">&#9670;&nbsp;</a></span>ri_yield()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___error.html#ga3e1919cc1fe75cb7f12af047f6f4ce55">rd_status_t</a> ri_yield </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function which will release execution. </p>
<p>The program execution will not continue until some external event continues the program.</p>
<dl class="section return"><dt>Returns</dt><dd>RD_SUCCESS on success, error code from stack on error. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>This function will never return unless external event occurs. </dd></dl>

</div>
</div>
<a id="ga98ea6648cb2f0858572aefb15085dbc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga98ea6648cb2f0858572aefb15085dbc0">&#9670;&nbsp;</a></span>ri_yield_indication_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ri_yield_indication_set </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group___yield.html#gad5480f7b0a184481c5574b2c5dc51967">ri_yield_state_ind_fp_t</a>&#160;</td>
          <td class="paramname"><em>indication</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Configure sleep indication function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">indication</td><td>function to call when entering/exiting sleep, NULL to disable </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga20f61ffc1f1ab0b0ee4124fb161be558"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga20f61ffc1f1ab0b0ee4124fb161be558">&#9670;&nbsp;</a></span>ri_yield_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___error.html#ga3e1919cc1fe75cb7f12af047f6f4ce55">rd_status_t</a> ri_yield_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes yielding functions. </p>
<p>Initializes necessary data stuctures and peripherals (if any) for yielding. May for example allocate a timer to wake the device up after delay is over.</p>
<dl class="section return"><dt>Returns</dt><dd>RD_SUCCESS on success, error code from stack on error. </dd></dl>

</div>
</div>
<a id="ga448f8ec0a3530ab6d6a14ef59bc5eafb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga448f8ec0a3530ab6d6a14ef59bc5eafb">&#9670;&nbsp;</a></span>ri_yield_is_interrupt_context()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ri_yield_is_interrupt_context </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if current execution is in interrupt context. </p>
<p>This function reads Interrupt Control and State Register (ICSR) to determine the interrupt status. The register is masked with VECTACTIVE mask.</p>
<dl class="section return"><dt>Returns</dt><dd>true if execution is currently in interrupt context, false otherwise. </dd></dl>

</div>
</div>
<a id="gafdd7b29a7f593e398104247709e1bf0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafdd7b29a7f593e398104247709e1bf0b">&#9670;&nbsp;</a></span>ri_yield_low_power_enable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___error.html#ga3e1919cc1fe75cb7f12af047f6f4ce55">rd_status_t</a> ri_yield_low_power_enable </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>enable</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes yielding functions. </p>
<p>Enables using timer + RTC to shutdown the device for millisecond-sleeps. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">enable</td><td>true to enable low-power mode, false to disable.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>RD_SUCCESS on success, error code from stack on error. </dd></dl>

</div>
</div>
<a id="ga013f419a3299af1e7353b2fa2d1756c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga013f419a3299af1e7353b2fa2d1756c2">&#9670;&nbsp;</a></span>ri_yield_uninit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___error.html#ga3e1919cc1fe75cb7f12af047f6f4ce55">rd_status_t</a> ri_yield_uninit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Uninitializes yielding functions. </p>
<p>Clears state from previous initializations. This should be called before uninitializing timers if timer-based low-power delay is in use.</p>
<dl class="section return"><dt>Returns</dt><dd>RD_SUCCESS. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
